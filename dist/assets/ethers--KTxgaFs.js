var Y=Object.defineProperty;var tt=(i,t,e)=>t in i?Y(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var v=(i,t,e)=>(tt(i,typeof t!="symbol"?t+"":t,e),e),V=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var s=(i,t,e)=>(V(i,t,"read from private field"),e?e.call(i):t.get(i)),b=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},k=(i,t,e,r)=>(V(i,t,"write to private field"),r?r.call(i,e):t.set(i,e),e);var f=(i,t,e)=>(V(i,t,"access private method"),e);const it="6.12.1";function j(i,t,e){for(let r in t){let n=t[r];Object.defineProperty(i,r,{enumerable:!0,value:n,writable:!1})}}function E(i){if(i==null)return"null";if(Array.isArray(i))return"[ "+i.map(E).join(", ")+" ]";if(i instanceof Uint8Array){const t="0123456789abcdef";let e="0x";for(let r=0;r<i.length;r++)e+=t[i[r]>>4],e+=t[i[r]&15];return e}if(typeof i=="object"&&typeof i.toJSON=="function")return E(i.toJSON());switch(typeof i){case"boolean":case"symbol":return i.toString();case"bigint":return BigInt(i).toString();case"number":return i.toString();case"string":return JSON.stringify(i);case"object":{const t=Object.keys(i);return t.sort(),"{ "+t.map(e=>"".concat(E(e),": ").concat(E(i[e]))).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function et(i,t,e){let r=i;{const o=[];if(e){if("message"in e||"code"in e||"name"in e)throw new Error("value will overwrite populated values: ".concat(E(e)));for(const c in e){if(c==="shortMessage")continue;const l=e[c];o.push(c+"="+E(l))}}o.push("code=".concat(t)),o.push("version=".concat(it)),o.length&&(i+=" ("+o.join(", ")+")")}let n;switch(t){case"INVALID_ARGUMENT":n=new TypeError(i);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":n=new RangeError(i);break;default:n=new Error(i)}return j(n,{code:t}),e&&Object.assign(n,e),n.shortMessage==null&&j(n,{shortMessage:r}),n}function g(i,t,e,r){if(!i)throw et(t,e,r)}function h(i,t,e,r){g(i,t,"INVALID_ARGUMENT",{argument:e,value:r})}["NFD","NFC","NFKD","NFKC"].reduce((i,t)=>{try{if("test".normalize(t)!=="test")throw new Error("bad");if(t==="NFD"&&"é".normalize("NFD")!=="é")throw new Error("broken");i.push(t)}catch(e){}return i},[]);function rt(i,t,e){if(i!==t){let r=e,n="new";r+=".",n+=" "+e,g(!1,"private constructor; use ".concat(r,"from* methods"),"UNSUPPORTED_OPERATION",{operation:n})}}function nt(i,t,e){if(i instanceof Uint8Array)return i;if(typeof i=="string"&&i.match(/^0x([0-9a-f][0-9a-f])*$/i)){const r=new Uint8Array((i.length-2)/2);let n=2;for(let o=0;o<r.length;o++)r[o]=parseInt(i.substring(n,n+2),16),n+=2;return r}h(!1,"invalid BytesLike value",t,i)}function st(i,t){return nt(i,t)}const X=BigInt(0),x=BigInt(1),F=9007199254740991;function D(i,t){const e=Q(i,"value"),r=BigInt($(t,"width"));if(g(e>>r===X,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:i}),e>>r-x){const n=(x<<r)-x;return-((~e&n)+x)}return e}function q(i,t){const e=Q(i,"value"),r=BigInt($(t,"bits"));return e&(x<<r)-x}function K(i,t){switch(typeof i){case"bigint":return i;case"number":return h(Number.isInteger(i),"underflow",t||"value",i),h(i>=-F&&i<=F,"overflow",t||"value",i),BigInt(i);case"string":try{if(i==="")throw new Error("empty string");return i[0]==="-"&&i[1]!=="-"?-BigInt(i.substring(1)):BigInt(i)}catch(e){h(!1,"invalid BigNumberish string: ".concat(e.message),t||"value",i)}}h(!1,"invalid BigNumberish value",t||"value",i)}function Q(i,t){const e=K(i,t);return g(e>=X,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:i}),e}const H="0123456789abcdef";function ot(i){if(i instanceof Uint8Array){let t="0x0";for(const e of i)t+=H[e>>4],t+=H[e&15];return BigInt(t)}return K(i)}function $(i,t){switch(typeof i){case"bigint":return h(i>=-F&&i<=F,"overflow",t||"value",i),Number(i);case"number":return h(Number.isInteger(i),"underflow",t||"value",i),h(i>=-F&&i<=F,"overflow",t||"value",i),i;case"string":try{if(i==="")throw new Error("empty string");return $(BigInt(i),t)}catch(e){h(!1,"invalid numeric string: ".concat(e.message),t||"value",i)}}h(!1,"invalid numeric value",t||"value",i)}const ut=BigInt(-1),d=BigInt(0),S=BigInt(1),ft=BigInt(5),B={};let A="0000";for(;A.length<80;)A+=A;function U(i){let t=A;for(;t.length<i;)t+=t;return BigInt("1"+t.substring(0,i))}function T(i,t,e){const r=BigInt(t.width);if(t.signed){const n=S<<r-S;g(e==null||i>=-n&&i<n,"overflow","NUMERIC_FAULT",{operation:e,fault:"overflow",value:i}),i>d?i=D(q(i,r),r):i=-D(q(-i,r),r)}else{const n=S<<r;g(e==null||i>=0&&i<n,"overflow","NUMERIC_FAULT",{operation:e,fault:"overflow",value:i}),i=(i%n+n)%n&n-S}return i}function O(i){typeof i=="number"&&(i="fixed128x".concat(i));let t=!0,e=128,r=18;if(typeof i=="string"){if(i!=="fixed")if(i==="ufixed")t=!1;else{const o=i.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);h(o,"invalid fixed format","format",i),t=o[1]!=="u",e=parseInt(o[2]),r=parseInt(o[3])}}else if(i){const o=i,c=(l,R,W)=>o[l]==null?W:(h(typeof o[l]===R,"invalid fixed format ("+l+" not "+R+")","format."+l,o[l]),o[l]);t=c("signed","boolean",t),e=c("width","number",e),r=c("decimals","number",r)}h(e%8===0,"invalid FixedNumber width (not byte aligned)","format.width",e),h(r<=80,"invalid FixedNumber decimals (too large)","format.decimals",r);const n=(t?"":"u")+"fixed"+String(e)+"x"+String(r);return{signed:t,width:e,decimals:r,name:n}}function ct(i,t){let e="";i<d&&(e="-",i*=ut);let r=i.toString();if(t===0)return e+r;for(;r.length<=t;)r=A+r;const n=r.length-t;for(r=r.substring(0,n)+"."+r.substring(n);r[0]==="0"&&r[1]!==".";)r=r.substring(1);for(;r[r.length-1]==="0"&&r[r.length-2]!==".";)r=r.substring(0,r.length-1);return e+r}var m,u,a,N,y,w,p,C,P,L,J,M,Z,_,G;const I=class I{constructor(t,e,r){b(this,N);b(this,w);b(this,C);b(this,L);b(this,M);b(this,_);v(this,"format");b(this,m,void 0);b(this,u,void 0);b(this,a,void 0);v(this,"_value");rt(t,B,"FixedNumber"),k(this,u,e),k(this,m,r);const n=ct(e,r.decimals);j(this,{format:r.name,_value:n}),k(this,a,U(r.decimals))}get signed(){return s(this,m).signed}get width(){return s(this,m).width}get decimals(){return s(this,m).decimals}get value(){return s(this,u)}addUnsafe(t){return f(this,C,P).call(this,t)}add(t){return f(this,C,P).call(this,t,"add")}subUnsafe(t){return f(this,L,J).call(this,t)}sub(t){return f(this,L,J).call(this,t,"sub")}mulUnsafe(t){return f(this,M,Z).call(this,t)}mul(t){return f(this,M,Z).call(this,t,"mul")}mulSignal(t){f(this,N,y).call(this,t);const e=s(this,u)*s(t,u);return g(e%s(this,a)===d,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),f(this,w,p).call(this,e/s(this,a),"mulSignal")}divUnsafe(t){return f(this,_,G).call(this,t)}div(t){return f(this,_,G).call(this,t,"div")}divSignal(t){g(s(t,u)!==d,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),f(this,N,y).call(this,t);const e=s(this,u)*s(this,a);return g(e%s(t,u)===d,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),f(this,w,p).call(this,e/s(t,u),"divSignal")}cmp(t){let e=this.value,r=t.value;const n=this.decimals-t.decimals;return n>0?r*=U(n):n<0&&(e*=U(-n)),e<r?-1:e>r?1:0}eq(t){return this.cmp(t)===0}lt(t){return this.cmp(t)<0}lte(t){return this.cmp(t)<=0}gt(t){return this.cmp(t)>0}gte(t){return this.cmp(t)>=0}floor(){let t=s(this,u);return s(this,u)<d&&(t-=s(this,a)-S),t=s(this,u)/s(this,a)*s(this,a),f(this,w,p).call(this,t,"floor")}ceiling(){let t=s(this,u);return s(this,u)>d&&(t+=s(this,a)-S),t=s(this,u)/s(this,a)*s(this,a),f(this,w,p).call(this,t,"ceiling")}round(t){if(t==null&&(t=0),t>=this.decimals)return this;const e=this.decimals-t,r=ft*U(e-1);let n=this.value+r;const o=U(e);return n=n/o*o,T(n,s(this,m),"round"),new I(B,n,s(this,m))}isZero(){return s(this,u)===d}isNegative(){return s(this,u)<d}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(t){return I.fromString(this.toString(),t)}static fromValue(t,e,r){const n=e==null?0:$(e),o=O(r);let c=K(t,"value");const l=n-o.decimals;if(l>0){const R=U(l);g(c%R===d,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:t}),c/=R}else l<0&&(c*=U(-l));return T(c,o,"fromValue"),new I(B,c,o)}static fromString(t,e){const r=t.match(/^(-?)([0-9]*)\.?([0-9]*)$/);h(r&&r[2].length+r[3].length>0,"invalid FixedNumber string value","value",t);const n=O(e);let o=r[2]||"0",c=r[3]||"";for(;c.length<n.decimals;)c+=A;g(c.substring(n.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:t}),c=c.substring(0,n.decimals);const l=BigInt(r[1]+o+c);return T(l,n,"fromString"),new I(B,l,n)}static fromBytes(t,e){let r=ot(st(t,"value"));const n=O(e);return n.signed&&(r=D(r,n.width)),T(r,n,"fromBytes"),new I(B,r,n)}};m=new WeakMap,u=new WeakMap,a=new WeakMap,N=new WeakSet,y=function(t){h(this.format===t.format,"incompatible format; use fixedNumber.toFormat","other",t)},w=new WeakSet,p=function(t,e){return t=T(t,s(this,m),e),new I(B,t,s(this,m))},C=new WeakSet,P=function(t,e){return f(this,N,y).call(this,t),f(this,w,p).call(this,s(this,u)+s(t,u),e)},L=new WeakSet,J=function(t,e){return f(this,N,y).call(this,t),f(this,w,p).call(this,s(this,u)-s(t,u),e)},M=new WeakSet,Z=function(t,e){return f(this,N,y).call(this,t),f(this,w,p).call(this,s(this,u)*s(t,u)/s(this,a),e)},_=new WeakSet,G=function(t,e){return g(s(t,u)!==d,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),f(this,N,y).call(this,t),f(this,w,p).call(this,s(this,u)*s(this,a)/s(t,u),e)};let z=I;function lt(i,t){let e=18;return e=$(t,"unit"),z.fromValue(i,e,{decimals:e,width:512}).toString()}function at(i){return lt(i,18)}export{at as f};
