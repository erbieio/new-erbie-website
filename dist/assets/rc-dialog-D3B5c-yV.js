import{e as f,d as de,g as _,c as Q}from"./@babel-DVGmkmWW.js";import{P as me}from"./@rc-component-CUxUE6TK.js";import{r as a,a as d}from"./react-Dbae-1t-.js";import{c as S}from"./classnames-CwUkGHy7.js";import{e as ve,A as oe,m as Ce,D as p,K as ee}from"./rc-util-BVoFLaC3.js";import{C as le}from"./rc-motion-BZqazZvp.js";var re=a.createContext({});function te(e,n,t){var o=n;return!o&&t&&(o="".concat(e,"-").concat(t)),o}function ae(e,n){var t=e["page".concat(n?"Y":"X","Offset")],o="scroll".concat(n?"Top":"Left");if(typeof t!="number"){var l=e.document;t=l.documentElement[o],typeof t!="number"&&(t=l.body[o])}return t}function ye(e){var n=e.getBoundingClientRect(),t={left:n.left,top:n.top},o=e.ownerDocument,l=o.defaultView||o.parentWindow;return t.left+=ae(l),t.top+=ae(l,!0),t}const be=a.memo(function(e){var n=e.children;return n},function(e,n){var t=n.shouldUpdate;return!t});var ne={width:0,height:0,overflow:"hidden",outline:"none"},Ne={outline:"none"},Re=d.forwardRef(function(e,n){var t=e.prefixCls,o=e.className,l=e.style,r=e.title,v=e.ariaId,m=e.footer,s=e.closable,C=e.closeIcon,b=e.onClose,h=e.children,N=e.bodyStyle,R=e.bodyProps,E=e.modalRender,x=e.onMouseDown,O=e.onMouseUp,V=e.holderRef,P=e.visible,M=e.forceRender,y=e.width,I=e.height,c=e.classNames,u=e.styles,L=d.useContext(re),H=L.panel,X=ve(V,H),U=a.useRef(),W=a.useRef(),k=a.useRef();d.useImperativeHandle(n,function(){return{focus:function(){var w;(w=k.current)===null||w===void 0||w.focus()},changeActive:function(w){var q=document,z=q.activeElement;w&&z===W.current?U.current.focus():!w&&z===U.current&&W.current.focus()}}});var g={};y!==void 0&&(g.width=y),I!==void 0&&(g.height=I);var A;m&&(A=d.createElement("div",{className:S("".concat(t,"-footer"),c==null?void 0:c.footer),style:f({},u==null?void 0:u.footer)},m));var D;r&&(D=d.createElement("div",{className:S("".concat(t,"-header"),c==null?void 0:c.header),style:f({},u==null?void 0:u.header)},d.createElement("div",{className:"".concat(t,"-title"),id:v},r)));var $=a.useMemo(function(){return de(s)==="object"&&s!==null?s:s?{closeIcon:C!=null?C:d.createElement("span",{className:"".concat(t,"-close-x")})}:{}},[s,C]),Y=oe($,!0),K;s&&(K=d.createElement("button",_({type:"button",onClick:b,"aria-label":"Close"},Y,{className:"".concat(t,"-close")}),$.closeIcon));var T=d.createElement("div",{className:S("".concat(t,"-content"),c==null?void 0:c.content),style:u==null?void 0:u.content},K,D,d.createElement("div",_({className:S("".concat(t,"-body"),c==null?void 0:c.body),style:f(f({},N),u==null?void 0:u.body)},R),h),A);return d.createElement("div",{key:"dialog-element",role:"dialog","aria-labelledby":r?v:null,"aria-modal":"true",ref:X,style:f(f({},l),g),className:S(t,o),onMouseDown:x,onMouseUp:O},d.createElement("div",{tabIndex:0,ref:U,style:ne,"aria-hidden":"true"}),d.createElement("div",{ref:k,tabIndex:-1,style:Ne},d.createElement(be,{shouldUpdate:P||M},E?E(T):T)),d.createElement("div",{tabIndex:0,ref:W,style:ne,"aria-hidden":"true"}))}),ie=a.forwardRef(function(e,n){var t=e.prefixCls,o=e.title,l=e.style,r=e.className,v=e.visible,m=e.forceRender,s=e.destroyOnClose,C=e.motionName,b=e.ariaId,h=e.onVisibleChanged,N=e.mousePosition,R=a.useRef(),E=a.useState(),x=Q(E,2),O=x[0],V=x[1],P={};O&&(P.transformOrigin=O);function M(){var y=ye(R.current);V(N?"".concat(N.x-y.left,"px ").concat(N.y-y.top,"px"):"")}return a.createElement(le,{visible:v,onVisibleChanged:h,onAppearPrepare:M,onEnterPrepare:M,forceRender:m,motionName:C,removeOnLeave:s,ref:R},function(y,I){var c=y.className,u=y.style;return a.createElement(Re,_({},e,{ref:n,title:o,ariaId:b,prefixCls:t,holderRef:I,style:f(f(f({},u),l),P),className:S(r,c)}))})});ie.displayName="Content";function ge(e){var n=e.prefixCls,t=e.style,o=e.visible,l=e.maskProps,r=e.motionName,v=e.className;return a.createElement(le,{key:"mask",visible:o,motionName:r,leavedClassName:"".concat(n,"-mask-hidden")},function(m,s){var C=m.className,b=m.style;return a.createElement("div",_({ref:s,style:f(f({},b),t),className:S("".concat(n,"-mask"),C,v)},l))})}function he(e){var n=e.prefixCls,t=n===void 0?"rc-dialog":n,o=e.zIndex,l=e.visible,r=l===void 0?!1:l,v=e.keyboard,m=v===void 0?!0:v,s=e.focusTriggerAfterClose,C=s===void 0?!0:s,b=e.wrapStyle,h=e.wrapClassName,N=e.wrapProps,R=e.onClose,E=e.afterOpenChange,x=e.afterClose,O=e.transitionName,V=e.animation,P=e.closable,M=P===void 0?!0:P,y=e.mask,I=y===void 0?!0:y,c=e.maskTransitionName,u=e.maskAnimation,L=e.maskClosable,H=L===void 0?!0:L,X=e.maskStyle,U=e.maskProps,W=e.rootClassName,k=e.classNames,g=e.styles,A=a.useRef(),D=a.useRef(),$=a.useRef(),Y=a.useState(r),K=Q(Y,2),T=K[0],j=K[1],w=Ce();function q(){p(D.current,document.activeElement)||(A.current=document.activeElement)}function z(){if(!p(D.current,document.activeElement)){var i;(i=$.current)===null||i===void 0||i.focus()}}function se(i){if(i)z();else{if(j(!1),I&&A.current&&C){try{A.current.focus({preventScroll:!0})}catch(J){}A.current=null}T&&(x==null||x())}E==null||E(i)}function F(i){R==null||R(i)}var B=a.useRef(!1),G=a.useRef(),ce=function(){clearTimeout(G.current),B.current=!0},ue=function(){G.current=setTimeout(function(){B.current=!1})},Z=null;H&&(Z=function(J){B.current?B.current=!1:D.current===J.target&&F(J)});function fe(i){if(m&&i.keyCode===ee.ESC){i.stopPropagation(),F(i);return}r&&i.keyCode===ee.TAB&&$.current.changeActive(!i.shiftKey)}return a.useEffect(function(){r&&(j(!0),q())},[r]),a.useEffect(function(){return function(){clearTimeout(G.current)}},[]),a.createElement("div",_({className:S("".concat(t,"-root"),W)},oe(e,{data:!0})),a.createElement(ge,{prefixCls:t,visible:I&&r,motionName:te(t,c,u),style:f(f({zIndex:o},X),g==null?void 0:g.mask),maskProps:U,className:k==null?void 0:k.mask}),a.createElement("div",_({tabIndex:-1,onKeyDown:fe,className:S("".concat(t,"-wrap"),h,k==null?void 0:k.wrapper),ref:D,onClick:Z,style:f(f(f({zIndex:o},b),g==null?void 0:g.wrapper),{},{display:T?null:"none"})},N),a.createElement(ie,_({},e,{onMouseDown:ce,onMouseUp:ue,ref:$,closable:M,ariaId:w,prefixCls:t,visible:r&&T,onClose:F,onVisibleChanged:se,motionName:te(t,O,V)}))))}var Ee=function(n){var t=n.visible,o=n.getContainer,l=n.forceRender,r=n.destroyOnClose,v=r===void 0?!1:r,m=n.afterClose,s=n.panelRef,C=a.useState(t),b=Q(C,2),h=b[0],N=b[1],R=a.useMemo(function(){return{panel:s}},[s]);return a.useEffect(function(){t&&N(!0)},[t]),!l&&v&&!h?null:a.createElement(re.Provider,{value:R},a.createElement(me,{open:t||l||h,autoDestroy:!1,getContainer:o,autoLock:t||h},a.createElement(he,_({},n,{destroyOnClose:v,afterClose:function(){m==null||m(),N(!1)}}))))};Ee.displayName="Dialog";export{Ee as D,Re as P};
